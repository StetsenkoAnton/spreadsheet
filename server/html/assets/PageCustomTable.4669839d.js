import{_ as m,o as a,c as u,a as i,b as F,w as d,v as g,t as h,n as k,d as T,e as S,F as b,r as x,f as V,g as _,h as y,i as v,j as R}from"./index.1f70d163.js";function I(l,e,n=()=>{}){return o=>{o.stopPropagation();let s=!1;!s&&l&&(s=l.contains(o.target)),!e.contains(o.target)&&!s&&n()}}const E={props:{dataTable:{type:Array,default(){return[]}},columnInfo:{type:Object,default(){return{index:0,name:""}}},sortInfo:{type:Object,default(){return{column:0,direction:""}}},filterInfo:{type:Array,default(){return[]}}},emits:["filtered"],mounted(){this.handleOutsideClick=I(this.$refs.opener,this.$refs.modal,this.canselFilter)},data(){return{handleOutsideClick:()=>{},isExact:!1,showFilterModal:!1,filter:{column:this.columnInfo.index,search:"",isExact:!1}}},computed:{filteredOrder(){return this.filterInfo.findIndex(({column:l})=>+l==+this.columnInfo.index)},filteredOrderView(){return this.filteredOrder+1},isCurrentFilter(){return this.filteredOrder>=0},currentFilter(){return this.filterInfo[this.filteredOrder]},unicValues(){const l=this.dataTable.map(({row:e})=>e[this.columnInfo.index].value);return new Set(l)}},methods:{openFilters(){this.showFilterModal=!0,this.resetValueFilter(),document.addEventListener("click",this.handleOutsideClick),this.$nextTick(()=>{this.$refs.search.focus()})},applyFilter(){this.closeFilter(),this.$emit("filtered",{index:this.filteredOrder,filter:this.filter})},canselFilter(){this.closeFilter(),this.resetValueFilter()},resetFilter(){this.closeFilter(),this.$emit("filtered",{index:this.filteredOrder,filter:null})},closeFilter(){this.showFilterModal=!1,document.removeEventListener("click",this.handleOutsideClick)},resetValueFilter(){this.isCurrentFilter&&(this.filter={...this.currentFilter})}}},L={class:"header-cell__filter"},U={class:"header-cell__filter-modal",ref:"modal"},D={class:"flex-between"},z=["list"],N=["id"],H=["value"],M=i("span",null,"Exact",-1),A={class:"flex-between"};function j(l,e,n,o,s,t){return a(),u("div",L,[i("button",{class:k({"header-cell__filter-btn--active":t.isCurrentFilter}),ref:"opener",type:"button",onClick:e[0]||(e[0]=(...r)=>t.openFilters&&t.openFilters(...r))},[F(" Filter "),d(i("span",null,h(t.filteredOrderView),513),[[g,t.isCurrentFilter]])],2),d(i("div",U,[d(i("div",D,[i("span",null,h(t.filteredOrderView)+" priority",1),i("button",{type:"button",onClick:e[1]||(e[1]=(...r)=>t.resetFilter&&t.resetFilter(...r))},"Reset")],512),[[g,t.isCurrentFilter]]),d(i("input",{type:"search",ref:"search",placeholder:"search","onUpdate:modelValue":e[2]||(e[2]=r=>s.filter.search=r),list:`datalistOptions${n.columnInfo.index}`,onKeydown:[e[3]||(e[3]=T((...r)=>t.applyFilter&&t.applyFilter(...r),["enter"])),e[4]||(e[4]=T((...r)=>t.canselFilter&&t.canselFilter(...r),["esc"]))]},null,40,z),[[S,s.filter.search]]),i("datalist",{id:`datalistOptions${n.columnInfo.index}`},[(a(!0),u(b,null,x(t.unicValues,r=>(a(),u("option",{key:r,value:r},null,8,H))),128))],8,N),i("label",null,[d(i("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=r=>s.filter.isExact=r)},null,512),[[V,s.filter.isExact]]),M]),i("div",A,[i("button",{type:"button",onClick:e[6]||(e[6]=(...r)=>t.applyFilter&&t.applyFilter(...r))},"Ok"),i("button",{type:"button",onClick:e[7]||(e[7]=(...r)=>t.canselFilter&&t.canselFilter(...r))},"Cansel")])],512),[[g,s.showFilterModal]])])}const B=m(E,[["render",j]]);const p=["abc","zyx",""],K={components:{CustomTableHeaderFilters:B},props:{dataTable:{type:Array,default(){return[]}},columnInfo:{type:Object,default(){return{index:0,name:""}}},sortInfo:{type:Object,default(){return{column:0,direction:""}}},filterInfo:{type:Array,default(){return[]}}},data(){return{showFilterModal:!1}},methods:{onSort(){const l=p.findIndex(n=>n===this.sortInfo.direction),e=l===p.length-1?p[0]:p[l+1];this.$emit("sorted",{column:this.columnInfo.index,direction:e})},onFilter(l){this.$emit("filtered",l)},openFilters(){this.showFilterModal=!0},applyFilter(){this.showFilterModal=!1},resetFilter(){this.showFilterModal=!1}}},q={class:"header-cell"},P=i("div",null,null,-1),Z={key:0},G={key:1};function J(l,e,n,o,s,t){const r=_("CustomTableHeaderFilters");return a(),u("div",q,[P,i("button",{class:"header-cell__sort",type:"button",onClick:e[0]||(e[0]=(...f)=>t.onSort&&t.onSort(...f))},[F(h(n.columnInfo.name)+" ",1),n.sortInfo.column===n.columnInfo.index?(a(),u(b,{key:0},[n.sortInfo.direction==="abc"?(a(),u("span",Z,"\u2193")):y("",!0),n.sortInfo.direction==="zyx"?(a(),u("span",G,"\u2191")):y("",!0)],64)):y("",!0)]),v(r,{"column-info":n.columnInfo,"data-table":n.dataTable,"filter-info":n.filterInfo,onSorted:t.onSort,onFiltered:t.onFilter},null,8,["column-info","data-table","filter-info","onSorted","onFiltered"])])}const Q=m(K,[["render",J]]),W={components:{CustomTableHeaderCell:Q},props:{dataTable:{type:Array,default(){return[]}},sortInfo:{type:Object,default(){return{column:0,direction:""}}},filterInfo:{type:Array,default(){return[]}}},emits:["sorted","filtered"],computed:{headerLength(){return this.dataTable[0].row.length},headerList(){const l=[];for(let e=1;e<=this.headerLength;e++)l.push({index:e-1,name:this.getAlphabetLetter(e)});return l}},methods:{getAlphabetLetter(l){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=e.length;let o=Math.trunc(l/n);const s=l-o*n;s||(o=o-1);const t=o?e[o-1]:"",r=s?e[s-1]:e[n-1];return`${t}${r}`},onSort(l){this.$emit("sorted",l)},onFilter(l){this.$emit("filtered",l)}}},X=i("th",null,null,-1);function Y(l,e,n,o,s,t){const r=_("CustomTableHeaderCell");return a(),u("thead",null,[i("tr",null,[X,(a(!0),u(b,null,x(t.headerList,f=>(a(),u("th",{key:f,class:"table__th"},[v(r,{"column-info":f,"data-table":n.dataTable,"filter-info":n.filterInfo,"sort-info":n.sortInfo,onSorted:t.onSort,onFiltered:t.onFilter},null,8,["column-info","data-table","filter-info","sort-info","onSorted","onFiltered"])]))),128))])])}const $=m(W,[["render",Y]]);const C={rest:"",edit:"edit",focus:"focus"},ee={components:{},props:{cellValue:{type:Object,default(){return{value:"",id:"0"}}},lineNumber:{type:Number,default:0}},emits:["input","selected","unselected"],data(){return{status:C.rest,handleOutsideClick:()=>{},cellRaw:""}},computed:{cellClass(){return{"table-cell":!0,"table-cell--edit":this.status===C.edit,"table-cell--selected":this.cellValue.selected}}},methods:{cellRest(){this.status=C.rest,this.onBlur(),document.removeEventListener("click",this.handleOutsideClick)},cellEdit(){this.cellValue.selected||(this.status=C.edit,this.cellRaw=this.cellValue.value,this.onSelect(),this.$nextTick(()=>{this.$refs.input.focus(),this.handleOutsideClick=I(null,this.$refs.cell,this.cellRest),document.addEventListener("click",this.handleOutsideClick)}))},getRequestDate(l){return{row:this.lineNumber,col:this.cellValue.column,value:l}},onChange(){this.$emit("input",this.getRequestDate(this.cellRaw))},onSelect(){this.$emit("selected",this.getRequestDate(this.cellValue.value))},onBlur(){this.$emit("unselected",this.getRequestDate(this.cellRaw))}}};function te(l,e,n,o,s,t){return a(),u("div",{class:k(t.cellClass),tabindex:"-1",ref:"cell",onDblclick:e[3]||(e[3]=(...r)=>t.cellEdit&&t.cellEdit(...r))},[s.status==="edit"?d((a(),u("input",{key:0,class:"table-cell__input",type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>s.cellRaw=r),ref:"input",onKeydown:[e[1]||(e[1]=T((...r)=>t.cellRest&&t.cellRest(...r),["enter"])),e[2]||(e[2]=T((...r)=>t.cellRest&&t.cellRest(...r),["esc"]))]},null,544)),[[S,s.cellRaw]]):y("",!0),i("span",null,h(n.cellValue.value),1)],34)}const le=m(ee,[["render",te]]);const ne={components:{CustomTableCell:le,CustomTableHeaderRow:$},props:{dataTable:{type:Array,default(){return[]}}},data(){return{fontSize:16,sortColumn:0,sortDirection:"",filtersSettings:[]}},computed:{filteredTable(){if(!this.filtersSettings.length)return this.dataTable;let l=this.dataTable;return this.filtersSettings.forEach(e=>{l=this.filterIteration(e,l)}),l},visibleTable(){return this.sortDirection?[...this.filteredTable].sort((l,e)=>{const n=l.row[this.sortColumn].value,o=e.row[this.sortColumn].value,s=typeof n=="number"?n:n.toString().toUpperCase(),t=typeof o=="number"?o:o.toString().toUpperCase();return s>t?this.sortDirection==="abc"?-1:1:this.sortDirection==="abc"?1:-1}):this.filteredTable},sortInfo(){return{column:this.sortColumn,direction:this.sortDirection}}},methods:{clearFilters(){this.filtersSettings=[],this.sortColumn=0,this.sortDirection=""},filterIteration(l,e){return e.filter(({row:n})=>{const o=l.search.toUpperCase(),s=n[l.column].value.toString().toUpperCase();return e.isExact?o===s:s.includes(o)})},onSort({column:l,direction:e}){this.sortColumn=l,this.sortDirection=e},onFilter({index:l,filter:e}){e?l<0&&e.search.length?this.filtersSettings.push(e):this.filtersSettings[l]=e:this.filtersSettings.splice(l,1)},onSelected(l){console.log(l)},onUnselected(l){console.log(l)}}},re=i("hr",null,null,-1),se={class:"table"},ie={class:"table__th"};function oe(l,e,n,o,s,t){const r=_("CustomTableHeaderRow"),f=_("CustomTableCell");return a(),u("div",null,[i("div",null,[F("Font size: "),d(i("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=c=>s.fontSize=c)},null,512),[[S,s.fontSize,void 0,{number:!0}]]),F("px")]),re,i("button",{type:"button",onClick:e[1]||(e[1]=(...c)=>t.clearFilters&&t.clearFilters(...c))},"Reset filters"),i("table",se,[v(r,{"data-table":n.dataTable,"filter-info":s.filtersSettings,"sort-info":t.sortInfo,onSorted:t.onSort,onFiltered:t.onFilter},null,8,["data-table","filter-info","sort-info","onSorted","onFiltered"]),i("tbody",{style:R({fontSize:`${s.fontSize}px`})},[(a(!0),u(b,null,x(t.visibleTable,({lineNumber:c,row:O})=>(a(),u("tr",{key:c},[i("th",ie,h(c+1),1),(a(!0),u(b,null,x(O,w=>(a(),u("td",{key:w.column,class:"table__td"},[v(f,{"cell-value":w,"line-number":c,onSelected:t.onSelected,onUnselected:t.onUnselected},null,8,["cell-value","line-number","onSelected","onUnselected"])]))),128))]))),128))],4)])])}const ae=m(ne,[["render",oe]]),ue={name:"PageCustom",components:{CustomTable:ae},mounted(){},data(){return{fontSize:16,firstValue:"Tagcat",cellComputed:[{row:0,col:0},{row:1,col:1}],rawTable:[{lineNumber:0,row:[{value:2,column:0},{value:"Tagcat",column:1},{value:"United Kingdom",column:2},{value:"Classic Vest",column:3},{value:"11/10/2020",column:4},{value:"01-2331942",column:5},{value:!0,column:6},{value:"172",column:7},{value:2,column:8},{value:22,column:9}]},{lineNumber:1,row:[{value:1,column:0},{value:"Zoomzone",column:1},{value:"Indonesia",column:2},{value:"Cycling Cap",column:3},{value:"03/05/2020",column:4},{value:"88-2768633",column:5},{value:!0,column:6},{value:"188",column:7},{value:6,column:8},{value:2,column:9}]},{lineNumber:2,row:[{value:10,column:0},{value:"Cycling",column:1},{value:"Ukraine",column:2},{value:"Dark Cap",column:3},{value:"05/09/2002",column:4},{value:"02-2768633",column:5},{value:!1,column:6},{value:"155",column:7},{value:1,column:8},{value:12,column:9}]},{lineNumber:3,row:[{value:11,column:0},{value:"Tagcat",column:1},{value:"China",column:2},{value:"Light Cap",column:3},{value:"09/09/2002",column:4},{value:"10-2768633",column:5},{value:!1,column:6},{value:"122",column:7},{value:4,column:8},{value:222,column:9}]}]}},computed:{dataTable(){const l=this.rawTable;return this.cellComputed.forEach(({row:e,col:n})=>{l[e].row[n].selected=!0}),l}},methods:{event(l,e,n,o,s,t){console.log(e,l,n,o,s,t)}}};function ce(l,e,n,o,s,t){const r=_("CustomTable");return a(),u("div",null,[v(r,{"data-table":t.dataTable,"selected-list":s.cellComputed,onCellSelected:t.event,onCellUpdated:t.event},null,8,["data-table","selected-list","onCellSelected","onCellUpdated"])])}const fe=m(ue,[["render",ce]]);export{fe as default};
